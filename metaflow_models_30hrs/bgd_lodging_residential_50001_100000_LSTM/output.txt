Metaflow 2.12.8 executing BGD_LinearFlow for user:nikhilkapila
Validating your flow...
    The graph looks good!
2024-07-19 15:06:55.318 Workflow starting (run-id 21):
2024-07-19 15:06:55.396 [21/start/249 (pid 11752)] Task is starting.
2024-07-19 15:06:57.050 [21/start/249 (pid 11752)] INFO:__main__:Starting BGD linear flow..
2024-07-19 15:06:57.381 [21/start/249 (pid 11752)] Task finished successfully.
2024-07-19 15:06:57.417 [21/ingest/250 (pid 11763)] Task is starting.
2024-07-19 15:06:58.990 [21/ingest/250 (pid 11763)] INFO:__main__:Fetching dataframe..
2024-07-19 15:06:59.015 [21/ingest/250 (pid 11763)] INFO:__main__:Dataframe fetching complete..
2024-07-19 15:07:03.102 [21/ingest/250 (pid 11763)] Task finished successfully.
2024-07-19 15:07:03.131 [21/pick_2017_data/251 (pid 11803)] Task is starting.
2024-07-19 15:07:04.636 [21/pick_2017_data/251 (pid 11803)] INFO:__main__:Picking 2017 data..
2024-07-19 15:07:05.005 [21/pick_2017_data/251 (pid 11803)] Task finished successfully.
2024-07-19 15:07:05.037 [21/fill_missing_data/252 (pid 11820)] Task is starting.
2024-07-19 15:07:06.519 [21/fill_missing_data/252 (pid 11820)] INFO:__main__:Filling missing data points using weighted average..
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] INFO:__main__:NaN counts per column:
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] INFO:__main__:Panther_lodging_Edison         11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Awilda         12
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Gale           11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Cornelia       11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Alita          11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Sonja          12
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Kaitlin        12
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Edmond         11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Tracie         11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Robin_lodging_Celia             0
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Fox_lodging_Wallace             1
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Fox_lodging_Alana               1
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Fox_lodging_Winifred            1
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Bear_lodging_Erick             38
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Cockatoo_lodging_Raphael      113
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Cockatoo_lodging_Josephine    121
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] dtype: int64
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] --- Logging error ---
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Traceback (most recent call last):
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/logging/__init__.py", line 1100, in emit
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] msg = self.format(record)
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/logging/__init__.py", line 943, in format
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] return fmt.format(record)
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/logging/__init__.py", line 678, in format
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] record.message = record.getMessage()
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/logging/__init__.py", line 368, in getMessage
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] msg = msg % self.args
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] TypeError: not all arguments converted during string formatting
2024-07-19 15:07:06.533 [21/fill_missing_data/252 (pid 11820)] Call stack:
2024-07-19 15:07:06.533 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/Developer/lstm-training/bgd_flow.py", line 337, in <module>
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] BGD_LinearFlow()
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/flowspec.py", line 120, in __init__
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] cli.main(self)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/cli.py", line 1126, in main
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] start(auto_envvar_prefix="METAFLOW", obj=state)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/tracing/__init__.py", line 27, in wrapper_func
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return func(*args, **kwargs)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 829, in __call__
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return self.main(*args, **kwargs)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 782, in main
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] rv = self.invoke(ctx)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 1259, in invoke
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return _process_result(sub_ctx.command.invoke(sub_ctx))
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 1066, in invoke
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return ctx.invoke(self.callback, **ctx.params)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 610, in invoke
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return callback(*args, **kwargs)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/decorators.py", line 21, in new_func
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return f(get_current_context(), *args, **kwargs)
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/cli.py", line 468, in step
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] task.run_step(
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/task.py", line 650, in run_step
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] self._exec_step_function(step_func)
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/task.py", line 62, in _exec_step_function
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] step_function()
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/Developer/lstm-training/bgd_flow.py", line 78, in fill_missing_data
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] self.missing_values = find_nan_counts(self.df)
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/Developer/lstm-training/bgd_flow.py", line 292, in find_nan_counts
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] logger.info("\nTotal NaN count in the DataFrame:", total_nan_count)
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] Message: '\nTotal NaN count in the DataFrame:'
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] Arguments: (377,)
2024-07-19 15:07:07.115 [21/fill_missing_data/252 (pid 11820)] Task finished successfully.
2024-07-19 15:07:07.149 [21/find_median/253 (pid 11831)] Task is starting.
2024-07-19 15:07:08.649 [21/find_median/253 (pid 11831)] INFO:__main__:Computing and using median..
2024-07-19 15:07:09.237 [21/find_median/253 (pid 11831)] Task finished successfully.
2024-07-19 15:07:09.273 [21/aggregate_data/254 (pid 11844)] Task is starting.
2024-07-19 15:07:10.821 [21/aggregate_data/254 (pid 11844)] INFO:__main__:Skipping.. data is on hourly basis.
2024-07-19 15:07:14.790 [21/aggregate_data/254 (pid 11844)] Task finished successfully.
2024-07-19 15:07:14.825 [21/split_data/255 (pid 11882)] Task is starting.
2024-07-19 15:07:16.321 [21/split_data/255 (pid 11882)] INFO:__main__:Splitting data into test and train...
2024-07-19 15:07:20.262 [21/split_data/255 (pid 11882)] Task finished successfully.
2024-07-19 15:07:20.292 [21/make_x_y/256 (pid 11920)] Task is starting.
2024-07-19 15:07:22.198 [21/make_x_y/256 (pid 11920)] INFO:__main__:Shape of X_train: (6978, 30, 1)
2024-07-19 15:07:22.529 [21/make_x_y/256 (pid 11920)] Shape of y_train: (6978, 1)
2024-07-19 15:07:22.529 [21/make_x_y/256 (pid 11920)] Shape of X_test: (1722, 30, 1)
2024-07-19 15:07:22.529 [21/make_x_y/256 (pid 11920)] Shape of y_test: (1722, 1)
2024-07-19 15:07:22.530 [21/make_x_y/256 (pid 11920)] Task finished successfully.
2024-07-19 15:07:22.564 [21/cross_validate_train/257 (pid 11931)] Task is starting.
2024-07-19 15:07:24.081 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Creating bgd_lodging_residential_50001_100000_LSTM
2024-07-19 15:07:24.082 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Performing cross validation..
2024-07-19 15:07:24.874 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.23172284400946386, Val Loss: 0.13723267695388278
2024-07-19 15:07:25.079 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.1770363655444738, Val Loss: 0.13293678112126686
2024-07-19 15:07:25.323 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.1694473040265006, Val Loss: 0.1264794829326707
2024-07-19 15:07:25.558 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.1574935005927408, Val Loss: 0.11758632676021473
2024-07-19 15:07:25.784 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.14805388893630053, Val Loss: 0.11040457297821303
2024-07-19 15:07:26.010 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.13625720505778854, Val Loss: 0.09715872358631443
2024-07-19 15:07:26.228 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.11694260384585406, Val Loss: 0.07272799947374575
2024-07-19 15:07:26.443 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.102768039985283, Val Loss: 0.06577321715854309
2024-07-19 15:07:26.658 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.09387700118728586, Val Loss: 0.06222181918250548
2024-07-19 15:07:26.875 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.08451076737932257, Val Loss: 0.059790784241379916
2024-07-19 15:07:27.089 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.07841297057834831, Val Loss: 0.060603358354922886
2024-07-19 15:07:27.296 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.07517865320315233, Val Loss: 0.059959271368948186
2024-07-19 15:07:27.505 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.06772615196737083, Val Loss: 0.057523332838271116
2024-07-19 15:07:27.729 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.06302648792798454, Val Loss: 0.0560025710713219
2024-07-19 15:07:27.954 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.06045486999524606, Val Loss: 0.05512172034060633
2024-07-19 15:07:28.176 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.05713765715827813, Val Loss: 0.05488860748104147
2024-07-19 15:07:28.388 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.05417719916314692, Val Loss: 0.0538550438107671
2024-07-19 15:07:28.601 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.05223381841504896, Val Loss: 0.05312795645079097
2024-07-19 15:07:28.814 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.050447822875670484, Val Loss: 0.0520397298843474
2024-07-19 15:07:29.035 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.0493064646080539, Val Loss: 0.05115149975628466
2024-07-19 15:07:29.261 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.04845370609011199, Val Loss: 0.05065879507644756
2024-07-19 15:07:29.496 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.04748700282259567, Val Loss: 0.04976483877446201
2024-07-19 15:07:29.722 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.04557695355568383, Val Loss: 0.048067611868719794
2024-07-19 15:07:29.947 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.04494652710855007, Val Loss: 0.048174130050717176
2024-07-19 15:07:30.182 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.04634863435215241, Val Loss: 0.049680528709211864
2024-07-19 15:07:30.437 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.04607764933560345, Val Loss: 0.0468242342609006
2024-07-19 15:07:30.691 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.043991595003250485, Val Loss: 0.045925209953172785
2024-07-19 15:07:30.934 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.04403570228935899, Val Loss: 0.047522489384219456
2024-07-19 15:07:31.161 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.04266033190730456, Val Loss: 0.04599029963483681
2024-07-19 15:07:31.392 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.042594226228224265, Val Loss: 0.04561603562654676
2024-07-19 15:07:31.628 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.042963690904749406, Val Loss: 0.04809575840025335
2024-07-19 15:07:31.861 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.04171066288207028, Val Loss: 0.046062791216615086
2024-07-19 15:07:32.107 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.04133397954944018, Val Loss: 0.04460161274953468
2024-07-19 15:07:32.332 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.041339120349368534, Val Loss: 0.047837845578386974
2024-07-19 15:07:32.554 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.04035055274898942, Val Loss: 0.04420940336343404
2024-07-19 15:07:32.772 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.04154724532083885, Val Loss: 0.04544108632851292
2024-07-19 15:07:32.992 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.042086077703012, Val Loss: 0.045099059069478836
2024-07-19 15:07:33.225 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.04046610345107478, Val Loss: 0.044838043684894975
2024-07-19 15:07:33.444 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.040111112232143815, Val Loss: 0.04460942684798627
2024-07-19 15:07:33.661 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.04005925015017793, Val Loss: 0.046205616984012966
2024-07-19 15:07:33.887 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.039297943632747676, Val Loss: 0.04348769899759743
2024-07-19 15:07:34.104 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.04027998261153698, Val Loss: 0.043889932737157154
2024-07-19 15:07:34.324 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.04030377332221817, Val Loss: 0.042980366915061664
2024-07-19 15:07:34.538 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.03923941720780488, Val Loss: 0.04426667300631871
2024-07-19 15:07:34.755 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.04099750196611559, Val Loss: 0.04576913861406816
2024-07-19 15:07:34.971 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.03905187657958752, Val Loss: 0.04299506041649226
2024-07-19 15:07:35.187 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.038572238405814044, Val Loss: 0.04303382095452901
2024-07-19 15:07:35.405 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.03835057376607044, Val Loss: 0.04297692650878752
2024-07-19 15:07:35.621 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.03842062241322285, Val Loss: 0.042833202140959536
2024-07-19 15:07:35.853 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.03833934760375603, Val Loss: 0.04200404338740014
2024-07-19 15:07:35.854 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 0, MAPE: 3.21%
2024-07-19 15:07:36.233 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f0_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:07:36.679 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.03691841067414578, Val Loss: 0.03965695665494816
2024-07-19 15:07:37.039 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.03858288857218337, Val Loss: 0.040171995104567426
2024-07-19 15:07:37.394 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.04319456046166485, Val Loss: 0.03407213872147573
2024-07-19 15:07:37.798 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.04621623772872637, Val Loss: 0.0327195984286231
2024-07-19 15:07:38.198 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.04322377541293836, Val Loss: 0.03166458962132802
2024-07-19 15:07:38.560 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.04140656132710307, Val Loss: 0.031186714063625078
2024-07-19 15:07:38.924 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.039866092933775625, Val Loss: 0.030979045641583366
2024-07-19 15:07:39.298 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.03926853218103108, Val Loss: 0.030612823779921274
2024-07-19 15:07:39.661 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.038462128005411524, Val Loss: 0.030278474948293454
2024-07-19 15:07:40.017 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.03772029464375483, Val Loss: 0.029914286037957347
2024-07-19 15:07:40.426 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.03818209415735447, Val Loss: 0.030169345992239745
2024-07-19 15:07:40.788 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.0384114909764022, Val Loss: 0.030113593448658247
2024-07-19 15:07:41.143 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.037466859955289596, Val Loss: 0.029858266783727182
2024-07-19 15:07:41.515 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.037907563685758476, Val Loss: 0.03026368952280766
2024-07-19 15:07:41.875 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.03774497244660169, Val Loss: 0.0299373466420818
2024-07-19 15:07:42.256 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.03758526481177709, Val Loss: 0.02984210300083096
2024-07-19 15:07:42.621 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.037777811237802245, Val Loss: 0.030194996025513957
2024-07-19 15:07:43.006 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.03777669995308739, Val Loss: 0.029824583766025467
2024-07-19 15:07:43.365 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.03715394853218777, Val Loss: 0.02988868629610216
2024-07-19 15:07:43.738 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.03783857590225462, Val Loss: 0.029753003319775737
2024-07-19 15:07:44.098 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.03726623416559337, Val Loss: 0.030014032397318532
2024-07-19 15:07:44.468 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.03737833190148007, Val Loss: 0.029488900575686147
2024-07-19 15:07:44.827 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.037080843129182514, Val Loss: 0.030268647884194914
2024-07-19 15:07:45.184 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.03756886919679707, Val Loss: 0.029447719152714755
2024-07-19 15:07:45.544 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.03690172137360867, Val Loss: 0.029924464084812114
2024-07-19 15:07:45.912 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.037609904060420925, Val Loss: 0.029527792203668003
2024-07-19 15:07:46.287 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.03665734317204724, Val Loss: 0.029444642012586463
2024-07-19 15:07:46.654 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.03651971326605098, Val Loss: 0.029481898842228425
2024-07-19 15:07:47.031 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.0371395540359902, Val Loss: 0.02935918088297586
2024-07-19 15:07:47.404 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.03665558210484786, Val Loss: 0.029381788159544404
2024-07-19 15:07:47.767 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.03664250595316495, Val Loss: 0.029477007485724783
2024-07-19 15:07:48.140 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.036667506070169685, Val Loss: 0.02914847418464519
2024-07-19 15:07:48.502 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.03653246638913677, Val Loss: 0.02956532148291936
2024-07-19 15:07:48.876 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.03694799953229623, Val Loss: 0.029212542633349832
2024-07-19 15:07:49.252 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.036517594468920195, Val Loss: 0.029396216510920913
2024-07-19 15:07:49.632 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.03656588599391996, Val Loss: 0.029253443954764185
2024-07-19 15:07:50.022 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.03624129928138158, Val Loss: 0.028897492064012063
2024-07-19 15:07:50.407 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.036123789311067696, Val Loss: 0.028943878976074425
2024-07-19 15:07:50.788 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.03618693448705216, Val Loss: 0.02861131073252575
2024-07-19 15:07:51.173 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.036158784305396145, Val Loss: 0.02927373646682984
2024-07-19 15:07:51.557 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.036898419643714, Val Loss: 0.02933420245913235
2024-07-19 15:07:51.971 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.03635414740810656, Val Loss: 0.02900273463613278
2024-07-19 15:07:52.375 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.03629064166994944, Val Loss: 0.0290324656745872
2024-07-19 15:07:52.772 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.03623168581254678, Val Loss: 0.02902222444882264
2024-07-19 15:07:53.135 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.03605560940524487, Val Loss: 0.028783524257911218
2024-07-19 15:07:53.563 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.0360042160657579, Val Loss: 0.028742486006907514
2024-07-19 15:07:54.012 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.03596948240309546, Val Loss: 0.02850926450982287
2024-07-19 15:07:54.429 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.03619782491395735, Val Loss: 0.02907513263257774
2024-07-19 15:07:54.835 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.03591022303659622, Val Loss: 0.028768615243402688
2024-07-19 15:07:55.246 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.03594836786593476, Val Loss: 0.02866804846436591
2024-07-19 15:07:55.247 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 1, MAPE: 2.59%
2024-07-19 15:07:55.350 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f1_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:07:55.892 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.03284657419743863, Val Loss: 0.026962225149209436
2024-07-19 15:07:56.515 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.03319052644073963, Val Loss: 0.02725166057211322
2024-07-19 15:07:57.134 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.033492202853614636, Val Loss: 0.02785103249590139
2024-07-19 15:07:57.782 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.03394023857333443, Val Loss: 0.028803946651719713
2024-07-19 15:07:58.329 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.03449669023129073, Val Loss: 0.028049901228498767
2024-07-19 15:07:58.837 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.03325154097242789, Val Loss: 0.027292471681092237
2024-07-19 15:07:59.344 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.03298386479304596, Val Loss: 0.02691302468647828
2024-07-19 15:07:59.852 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.032677863809195434, Val Loss: 0.026939499468819517
2024-07-19 15:08:00.353 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.03251879448917779, Val Loss: 0.02723120807393177
2024-07-19 15:08:00.855 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.03249187831851569, Val Loss: 0.027072894965877402
2024-07-19 15:08:01.363 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.03272138449617407, Val Loss: 0.027573701900404854
2024-07-19 15:08:01.888 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.03268267224458131, Val Loss: 0.027320606734704326
2024-07-19 15:08:02.388 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.03254770504480058, Val Loss: 0.027382628388098768
2024-07-19 15:08:02.888 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.03248326695439491, Val Loss: 0.02751048609010271
2024-07-19 15:08:03.392 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.03247955363582481, Val Loss: 0.027793610116114486
2024-07-19 15:08:03.897 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.03379338521679694, Val Loss: 0.028678540794833285
2024-07-19 15:08:04.398 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.03384105845947157, Val Loss: 0.02834725586345067
2024-07-19 15:08:04.913 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.03323688041418791, Val Loss: 0.0275260131000667
2024-07-19 15:08:05.415 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.032805321856655856, Val Loss: 0.02725411075595263
2024-07-19 15:08:05.919 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.03283616542308168, Val Loss: 0.027724323743903958
2024-07-19 15:08:06.425 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.03297987578606064, Val Loss: 0.027476239647414233
2024-07-19 15:08:06.924 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.0327053504911336, Val Loss: 0.027710098773241043
2024-07-19 15:08:07.432 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.03231213033537973, Val Loss: 0.02674155934034167
2024-07-19 15:08:07.930 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.03269786172631112, Val Loss: 0.02725680746339463
2024-07-19 15:08:08.432 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.032789245942099525, Val Loss: 0.027945296939563106
2024-07-19 15:08:08.933 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.032941222986714404, Val Loss: 0.02743089516219255
2024-07-19 15:08:09.440 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.032398582419211217, Val Loss: 0.027058065894085007
2024-07-19 15:08:09.945 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.03245893982662396, Val Loss: 0.027539115801856324
2024-07-19 15:08:10.446 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.03220607709478248, Val Loss: 0.026841242118058977
2024-07-19 15:08:10.961 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.03239655447277156, Val Loss: 0.027476858951755473
2024-07-19 15:08:11.464 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.03235514143651182, Val Loss: 0.026989137200084893
2024-07-19 15:08:11.973 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.0324674072929404, Val Loss: 0.027107016258948558
2024-07-19 15:08:12.474 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.032139169018376955, Val Loss: 0.026979818789137376
2024-07-19 15:08:12.981 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.032224813069809566, Val Loss: 0.026923665072064142
2024-07-19 15:08:13.490 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.032079896906560115, Val Loss: 0.02698343901618107
2024-07-19 15:08:13.989 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.032157680730928076, Val Loss: 0.0270770505775471
2024-07-19 15:08:14.493 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.03206351529806852, Val Loss: 0.026656729748120177
2024-07-19 15:08:14.993 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.03247079803523692, Val Loss: 0.02686392334667412
2024-07-19 15:08:15.498 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.03190780690109188, Val Loss: 0.02670071500580053
2024-07-19 15:08:15.999 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.032117162306200375, Val Loss: 0.02664681035723235
2024-07-19 15:08:16.513 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.03214940855448896, Val Loss: 0.026902963835242634
2024-07-19 15:08:17.012 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.03207944379272786, Val Loss: 0.02735171462031635
2024-07-19 15:08:17.520 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.03207829660651359, Val Loss: 0.026867992068464693
2024-07-19 15:08:18.020 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.032114232280714944, Val Loss: 0.027031073799809895
2024-07-19 15:08:18.520 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.03218822443688458, Val Loss: 0.027418308664818068
2024-07-19 15:08:19.027 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.03255900313908404, Val Loss: 0.027783909762227856
2024-07-19 15:08:19.530 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.033505328981713815, Val Loss: 0.027738534719557374
2024-07-19 15:08:20.039 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.03269326199184765, Val Loss: 0.027306135492147627
2024-07-19 15:08:20.536 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.032510936598886146, Val Loss: 0.027263404096703272
2024-07-19 15:08:21.050 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.03248160362920978, Val Loss: 0.02759102012055951
2024-07-19 15:08:21.050 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 2, MAPE: 2.72%
2024-07-19 15:08:21.151 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f2_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:08:21.827 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.03143719473394425, Val Loss: 0.03325181721231422
2024-07-19 15:08:22.525 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.03141124073211869, Val Loss: 0.03264639652460008
2024-07-19 15:08:23.215 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.03118399558716441, Val Loss: 0.03275497610101829
2024-07-19 15:08:23.877 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.031056913738585497, Val Loss: 0.03263888835302881
2024-07-19 15:08:24.526 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.031052326464591776, Val Loss: 0.03288822570765341
2024-07-19 15:08:25.172 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.031022890394374933, Val Loss: 0.033459308733408515
2024-07-19 15:08:25.826 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.030926810526480414, Val Loss: 0.033248726228201714
2024-07-19 15:08:26.479 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.030922568607309908, Val Loss: 0.03336223612564641
2024-07-19 15:08:27.147 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.03094955439334863, Val Loss: 0.033638637311555246
2024-07-19 15:08:27.830 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.03088520048824075, Val Loss: 0.03364362899918814
2024-07-19 15:08:28.504 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.031008098274469376, Val Loss: 0.03279340977000224
2024-07-19 15:08:29.180 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.03088138082817401, Val Loss: 0.032836162460011406
2024-07-19 15:08:29.853 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.030725294813411692, Val Loss: 0.03356996772659791
2024-07-19 15:08:30.574 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.03083240937390556, Val Loss: 0.03310372932134448
2024-07-19 15:08:31.263 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.030876555429031588, Val Loss: 0.03306398143035334
2024-07-19 15:08:31.966 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.030815946729215858, Val Loss: 0.033493411047635854
2024-07-19 15:08:32.635 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.030785274245355227, Val Loss: 0.0331235607028813
2024-07-19 15:08:33.304 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.030667328428834267, Val Loss: 0.033277808965460676
2024-07-19 15:08:33.986 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.030588042016511094, Val Loss: 0.03349242434912437
2024-07-19 15:08:34.659 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.030898660395855773, Val Loss: 0.033911087726419036
2024-07-19 15:08:35.328 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.030854704292261437, Val Loss: 0.033362910403190435
2024-07-19 15:08:36.015 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.030864284067631583, Val Loss: 0.03325284071065284
2024-07-19 15:08:36.688 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.030634783705926105, Val Loss: 0.03316149850552146
2024-07-19 15:08:37.357 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.030682338758894843, Val Loss: 0.033662087560908216
2024-07-19 15:08:38.028 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.030756638768090778, Val Loss: 0.03355310444493551
2024-07-19 15:08:38.692 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.03076883587884168, Val Loss: 0.0338616246810636
2024-07-19 15:08:39.366 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.030680379970637085, Val Loss: 0.03376196732593549
2024-07-19 15:08:40.048 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.03053968994278614, Val Loss: 0.0338327358602672
2024-07-19 15:08:40.721 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.03051279486501462, Val Loss: 0.033848778218836396
2024-07-19 15:08:41.411 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.03062904539377722, Val Loss: 0.03362319990992546
2024-07-19 15:08:42.093 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.030384240238225623, Val Loss: 0.033124699030776285
2024-07-19 15:08:42.766 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.03039158790129913, Val Loss: 0.03376814556887021
2024-07-19 15:08:43.433 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.030225026842257748, Val Loss: 0.033511999742807566
2024-07-19 15:08:44.106 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.03031433705393582, Val Loss: 0.034048809191665134
2024-07-19 15:08:44.810 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.030204135171864946, Val Loss: 0.033645546265147826
2024-07-19 15:08:45.469 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.030288311155283288, Val Loss: 0.03347506469770058
2024-07-19 15:08:46.145 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.030116484168763846, Val Loss: 0.033819376969256916
2024-07-19 15:08:46.811 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.03018917647279697, Val Loss: 0.03408045648924402
2024-07-19 15:08:47.482 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.030269162002185435, Val Loss: 0.03455443272518145
2024-07-19 15:08:48.158 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.030154332186873644, Val Loss: 0.03453944482513376
2024-07-19 15:08:48.829 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.030144967406681957, Val Loss: 0.03442783089908394
2024-07-19 15:08:49.508 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.030163660313780993, Val Loss: 0.03365449672816573
2024-07-19 15:08:50.190 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.030053700333180493, Val Loss: 0.03411884626021256
2024-07-19 15:08:50.866 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.030257333542079958, Val Loss: 0.03322340608448596
2024-07-19 15:08:51.577 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.02978156415158755, Val Loss: 0.03418839586949026
2024-07-19 15:08:52.264 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.030096869201284564, Val Loss: 0.03353581990341883
2024-07-19 15:08:52.943 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.03010225538419534, Val Loss: 0.033397554092713305
2024-07-19 15:08:53.599 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.03009593272454118, Val Loss: 0.03317842194558801
2024-07-19 15:08:54.265 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.029913274418205432, Val Loss: 0.032902567722910156
2024-07-19 15:08:54.927 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.029875071681015296, Val Loss: 0.033104389100461394
2024-07-19 15:08:54.928 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 3, MAPE: 3.04%
2024-07-19 15:08:55.027 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f3_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:08:55.833 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.030065400541279014, Val Loss: 0.041756289734228236
2024-07-19 15:08:56.676 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.029463400383694813, Val Loss: 0.04309492658924412
2024-07-19 15:08:57.508 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.029696096492173907, Val Loss: 0.04494181637828414
2024-07-19 15:08:58.336 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.029684728973514433, Val Loss: 0.04671531825049503
2024-07-19 15:08:59.174 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.029769239102868914, Val Loss: 0.049228780273650144
2024-07-19 15:09:00.001 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.02984181845274109, Val Loss: 0.04747025779372937
2024-07-19 15:09:00.845 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.029819623515992374, Val Loss: 0.04813301412237657
2024-07-19 15:09:01.740 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.029876574976267396, Val Loss: 0.04631947816626446
2024-07-19 15:09:02.605 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.029787088539656045, Val Loss: 0.04661983100546373
2024-07-19 15:09:03.425 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.029840404618081157, Val Loss: 0.041625653016003406
2024-07-19 15:09:04.262 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.029527508121516024, Val Loss: 0.0449652313380628
2024-07-19 15:09:05.095 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.029486024051208745, Val Loss: 0.0397438297702654
2024-07-19 15:09:05.923 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.029411714247704206, Val Loss: 0.04358296876622213
2024-07-19 15:09:06.748 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.029357634955546358, Val Loss: 0.04119713473561648
2024-07-19 15:09:07.576 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.02938381040079908, Val Loss: 0.04185626237980417
2024-07-19 15:09:08.414 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.02940556095851647, Val Loss: 0.041051585781010425
2024-07-19 15:09:09.253 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.029397498539925276, Val Loss: 0.0438032744301332
2024-07-19 15:09:10.088 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.02930669509549881, Val Loss: 0.03881567132634085
2024-07-19 15:09:10.925 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.02922665622023927, Val Loss: 0.041825865621905066
2024-07-19 15:09:11.777 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.02931192871899559, Val Loss: 0.04026881132174183
2024-07-19 15:09:12.604 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.029067123319012123, Val Loss: 0.03932534767365133
2024-07-19 15:09:13.448 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.02917080069124535, Val Loss: 0.0414111273916992
2024-07-19 15:09:14.279 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.02918580048052328, Val Loss: 0.0374753057856012
2024-07-19 15:09:15.108 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.029192409703282865, Val Loss: 0.04317062801203212
2024-07-19 15:09:15.937 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.029179408834162323, Val Loss: 0.04006489683446046
2024-07-19 15:09:16.772 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.02917934877920773, Val Loss: 0.043181130813585746
2024-07-19 15:09:17.572 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.029163486221907557, Val Loss: 0.04314817115664482
2024-07-19 15:09:18.376 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.029116089542775034, Val Loss: 0.039087463975758165
2024-07-19 15:09:19.179 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.02897516094598469, Val Loss: 0.03962500745782981
2024-07-19 15:09:19.981 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.028971569290241368, Val Loss: 0.0383226953044131
2024-07-19 15:09:20.784 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.02892070619266603, Val Loss: 0.036943493864020786
2024-07-19 15:09:21.607 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.029043317905494144, Val Loss: 0.04008657006999931
2024-07-19 15:09:22.421 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.02902827032708696, Val Loss: 0.0369392587627108
2024-07-19 15:09:23.225 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.028924308850296905, Val Loss: 0.0381389702292713
2024-07-19 15:09:24.054 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.028894581059300966, Val Loss: 0.037027892077694066
2024-07-19 15:09:24.875 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.028907178558286402, Val Loss: 0.03805289830307703
2024-07-19 15:09:25.702 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.028870226641359565, Val Loss: 0.03770607991798504
2024-07-19 15:09:26.550 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.028746044790310846, Val Loss: 0.035673930083174966
2024-07-19 15:09:27.378 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.028798783970689707, Val Loss: 0.036790621995523166
2024-07-19 15:09:28.208 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.028687764516939503, Val Loss: 0.036270944854697666
2024-07-19 15:09:29.049 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.02876419936317009, Val Loss: 0.03828186305189455
2024-07-19 15:09:29.871 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.02872197841202001, Val Loss: 0.03571414177280825
2024-07-19 15:09:30.689 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.028685245703864885, Val Loss: 0.03503877055403348
2024-07-19 15:09:31.537 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.02861067196251927, Val Loss: 0.03425022743239596
2024-07-19 15:09:32.391 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.02867555620844711, Val Loss: 0.03782854974269867
2024-07-19 15:09:33.225 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.02851995676858248, Val Loss: 0.03629346212019791
2024-07-19 15:09:34.061 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.02872170727433903, Val Loss: 0.03671510628349072
2024-07-19 15:09:34.892 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.028647470600125225, Val Loss: 0.03591037496320299
2024-07-19 15:09:35.720 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.028668901755136776, Val Loss: 0.037055213809818834
2024-07-19 15:09:36.559 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.028548789410186664, Val Loss: 0.03678788979713981
2024-07-19 15:09:36.559 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 4, MAPE: 3.05%
2024-07-19 15:09:36.668 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f4_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:09:41.222 [21/cross_validate_train/257 (pid 11931)] Task finished successfully.
2024-07-19 15:09:41.247 [21/model_scores/258 (pid 12521)] Task is starting.
2024-07-19 15:09:42.839 [21/model_scores/258 (pid 12521)] INFO:__main__:Average Train Loss across all folds: 0.0330386360380205
2024-07-19 15:09:47.118 [21/model_scores/258 (pid 12521)] INFO:__main__:Average Validation Loss across all folds: 0.03363107817398535
2024-07-19 15:09:47.119 [21/model_scores/258 (pid 12521)] INFO:__main__:Average MAPE across all folds: 2.92%
2024-07-19 15:09:47.120 [21/model_scores/258 (pid 12521)] Task finished successfully.
2024-07-19 15:09:47.153 [21/validate_model/259 (pid 12569)] Task is starting.
2024-07-19 15:09:48.670 [21/validate_model/259 (pid 12569)] INFO:__main__:Validating LSTM on test set..
2024-07-19 15:09:48.875 [21/validate_model/259 (pid 12569)] INFO:__main__:Test Set MAPE: 3.95%
2024-07-19 15:09:49.294 [21/validate_model/259 (pid 12569)] INFO:__main__:Test image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//test_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:09:49.809 [21/validate_model/259 (pid 12569)] Task finished successfully.
2024-07-19 15:09:49.853 [21/log_model/260 (pid 12589)] Task is starting.
2024-07-19 15:09:51.427 [21/log_model/260 (pid 12589)] INFO:__main__:Logging model bgd_lodging_residential_50001_100000_LSTM
2024-07-19 15:09:51.428 [21/log_model/260 (pid 12589)] INFO:__main__:Model logged at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//bgd_lodging_residential_50001_100000_LSTM.pth
2024-07-19 15:09:55.679 [21/log_model/260 (pid 12589)] Task finished successfully.
2024-07-19 15:09:55.706 [21/end/261 (pid 12629)] Task is starting.
2024-07-19 15:09:57.242 [21/end/261 (pid 12629)] INFO:__main__:Pipeline end.
2024-07-19 15:09:57.564 [21/end/261 (pid 12629)] Task finished successfully.
2024-07-19 15:09:57.564 Done!
Starting Metaflow run.
✅ Run('BGD_LinearFlow/21') succeeded:
-- stdout --
2024-07-19 15:06:55.318 Workflow starting (run-id 21):
2024-07-19 15:06:55.396 [21/start/249 (pid 11752)] Task is starting.
2024-07-19 15:06:57.050 [21/start/249 (pid 11752)] INFO:__main__:Starting BGD linear flow..
2024-07-19 15:06:57.381 [21/start/249 (pid 11752)] Task finished successfully.
2024-07-19 15:06:57.417 [21/ingest/250 (pid 11763)] Task is starting.
2024-07-19 15:06:58.990 [21/ingest/250 (pid 11763)] INFO:__main__:Fetching dataframe..
2024-07-19 15:06:59.015 [21/ingest/250 (pid 11763)] INFO:__main__:Dataframe fetching complete..
2024-07-19 15:07:03.102 [21/ingest/250 (pid 11763)] Task finished successfully.
2024-07-19 15:07:03.131 [21/pick_2017_data/251 (pid 11803)] Task is starting.
2024-07-19 15:07:04.636 [21/pick_2017_data/251 (pid 11803)] INFO:__main__:Picking 2017 data..
2024-07-19 15:07:05.005 [21/pick_2017_data/251 (pid 11803)] Task finished successfully.
2024-07-19 15:07:05.037 [21/fill_missing_data/252 (pid 11820)] Task is starting.
2024-07-19 15:07:06.519 [21/fill_missing_data/252 (pid 11820)] INFO:__main__:Filling missing data points using weighted average..
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] INFO:__main__:NaN counts per column:
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] INFO:__main__:Panther_lodging_Edison         11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Awilda         12
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Gale           11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Cornelia       11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Alita          11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Sonja          12
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Kaitlin        12
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Edmond         11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Panther_lodging_Tracie         11
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Robin_lodging_Celia             0
2024-07-19 15:07:06.530 [21/fill_missing_data/252 (pid 11820)] Fox_lodging_Wallace             1
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Fox_lodging_Alana               1
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Fox_lodging_Winifred            1
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Bear_lodging_Erick             38
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Cockatoo_lodging_Raphael      113
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Cockatoo_lodging_Josephine    121
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] dtype: int64
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] --- Logging error ---
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] Traceback (most recent call last):
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/logging/__init__.py", line 1100, in emit
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] msg = self.format(record)
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/logging/__init__.py", line 943, in format
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] return fmt.format(record)
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/logging/__init__.py", line 678, in format
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] record.message = record.getMessage()
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/logging/__init__.py", line 368, in getMessage
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] msg = msg % self.args
2024-07-19 15:07:06.531 [21/fill_missing_data/252 (pid 11820)] TypeError: not all arguments converted during string formatting
2024-07-19 15:07:06.533 [21/fill_missing_data/252 (pid 11820)] Call stack:
2024-07-19 15:07:06.533 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/Developer/lstm-training/bgd_flow.py", line 337, in <module>
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] BGD_LinearFlow()
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/flowspec.py", line 120, in __init__
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] cli.main(self)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/cli.py", line 1126, in main
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] start(auto_envvar_prefix="METAFLOW", obj=state)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/tracing/__init__.py", line 27, in wrapper_func
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return func(*args, **kwargs)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 829, in __call__
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return self.main(*args, **kwargs)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 782, in main
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] rv = self.invoke(ctx)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 1259, in invoke
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return _process_result(sub_ctx.command.invoke(sub_ctx))
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 1066, in invoke
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return ctx.invoke(self.callback, **ctx.params)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/core.py", line 610, in invoke
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return callback(*args, **kwargs)
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/_vendor/click/decorators.py", line 21, in new_func
2024-07-19 15:07:07.113 [21/fill_missing_data/252 (pid 11820)] return f(get_current_context(), *args, **kwargs)
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/cli.py", line 468, in step
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] task.run_step(
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/task.py", line 650, in run_step
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] self._exec_step_function(step_func)
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/miniconda3/envs/8903env/lib/python3.10/site-packages/metaflow/task.py", line 62, in _exec_step_function
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] step_function()
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/Developer/lstm-training/bgd_flow.py", line 78, in fill_missing_data
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] self.missing_values = find_nan_counts(self.df)
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] File "/Users/nikhilkapila/Developer/lstm-training/bgd_flow.py", line 292, in find_nan_counts
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] logger.info("\nTotal NaN count in the DataFrame:", total_nan_count)
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] Message: '\nTotal NaN count in the DataFrame:'
2024-07-19 15:07:07.114 [21/fill_missing_data/252 (pid 11820)] Arguments: (377,)
2024-07-19 15:07:07.115 [21/fill_missing_data/252 (pid 11820)] Task finished successfully.
2024-07-19 15:07:07.149 [21/find_median/253 (pid 11831)] Task is starting.
2024-07-19 15:07:08.649 [21/find_median/253 (pid 11831)] INFO:__main__:Computing and using median..
2024-07-19 15:07:09.237 [21/find_median/253 (pid 11831)] Task finished successfully.
2024-07-19 15:07:09.273 [21/aggregate_data/254 (pid 11844)] Task is starting.
2024-07-19 15:07:10.821 [21/aggregate_data/254 (pid 11844)] INFO:__main__:Skipping.. data is on hourly basis.
2024-07-19 15:07:14.790 [21/aggregate_data/254 (pid 11844)] Task finished successfully.
2024-07-19 15:07:14.825 [21/split_data/255 (pid 11882)] Task is starting.
2024-07-19 15:07:16.321 [21/split_data/255 (pid 11882)] INFO:__main__:Splitting data into test and train...
2024-07-19 15:07:20.262 [21/split_data/255 (pid 11882)] Task finished successfully.
2024-07-19 15:07:20.292 [21/make_x_y/256 (pid 11920)] Task is starting.
2024-07-19 15:07:22.198 [21/make_x_y/256 (pid 11920)] INFO:__main__:Shape of X_train: (6978, 30, 1)
2024-07-19 15:07:22.529 [21/make_x_y/256 (pid 11920)] Shape of y_train: (6978, 1)
2024-07-19 15:07:22.529 [21/make_x_y/256 (pid 11920)] Shape of X_test: (1722, 30, 1)
2024-07-19 15:07:22.529 [21/make_x_y/256 (pid 11920)] Shape of y_test: (1722, 1)
2024-07-19 15:07:22.530 [21/make_x_y/256 (pid 11920)] Task finished successfully.
2024-07-19 15:07:22.564 [21/cross_validate_train/257 (pid 11931)] Task is starting.
2024-07-19 15:07:24.081 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Creating bgd_lodging_residential_50001_100000_LSTM
2024-07-19 15:07:24.082 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Performing cross validation..
2024-07-19 15:07:24.874 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.23172284400946386, Val Loss: 0.13723267695388278
2024-07-19 15:07:25.079 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.1770363655444738, Val Loss: 0.13293678112126686
2024-07-19 15:07:25.323 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.1694473040265006, Val Loss: 0.1264794829326707
2024-07-19 15:07:25.558 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.1574935005927408, Val Loss: 0.11758632676021473
2024-07-19 15:07:25.784 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.14805388893630053, Val Loss: 0.11040457297821303
2024-07-19 15:07:26.010 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.13625720505778854, Val Loss: 0.09715872358631443
2024-07-19 15:07:26.228 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.11694260384585406, Val Loss: 0.07272799947374575
2024-07-19 15:07:26.443 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.102768039985283, Val Loss: 0.06577321715854309
2024-07-19 15:07:26.658 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.09387700118728586, Val Loss: 0.06222181918250548
2024-07-19 15:07:26.875 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.08451076737932257, Val Loss: 0.059790784241379916
2024-07-19 15:07:27.089 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.07841297057834831, Val Loss: 0.060603358354922886
2024-07-19 15:07:27.296 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.07517865320315233, Val Loss: 0.059959271368948186
2024-07-19 15:07:27.505 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.06772615196737083, Val Loss: 0.057523332838271116
2024-07-19 15:07:27.729 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.06302648792798454, Val Loss: 0.0560025710713219
2024-07-19 15:07:27.954 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.06045486999524606, Val Loss: 0.05512172034060633
2024-07-19 15:07:28.176 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.05713765715827813, Val Loss: 0.05488860748104147
2024-07-19 15:07:28.388 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.05417719916314692, Val Loss: 0.0538550438107671
2024-07-19 15:07:28.601 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.05223381841504896, Val Loss: 0.05312795645079097
2024-07-19 15:07:28.814 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.050447822875670484, Val Loss: 0.0520397298843474
2024-07-19 15:07:29.035 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.0493064646080539, Val Loss: 0.05115149975628466
2024-07-19 15:07:29.261 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.04845370609011199, Val Loss: 0.05065879507644756
2024-07-19 15:07:29.496 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.04748700282259567, Val Loss: 0.04976483877446201
2024-07-19 15:07:29.722 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.04557695355568383, Val Loss: 0.048067611868719794
2024-07-19 15:07:29.947 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.04494652710855007, Val Loss: 0.048174130050717176
2024-07-19 15:07:30.182 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.04634863435215241, Val Loss: 0.049680528709211864
2024-07-19 15:07:30.437 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.04607764933560345, Val Loss: 0.0468242342609006
2024-07-19 15:07:30.691 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.043991595003250485, Val Loss: 0.045925209953172785
2024-07-19 15:07:30.934 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.04403570228935899, Val Loss: 0.047522489384219456
2024-07-19 15:07:31.161 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.04266033190730456, Val Loss: 0.04599029963483681
2024-07-19 15:07:31.392 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.042594226228224265, Val Loss: 0.04561603562654676
2024-07-19 15:07:31.628 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.042963690904749406, Val Loss: 0.04809575840025335
2024-07-19 15:07:31.861 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.04171066288207028, Val Loss: 0.046062791216615086
2024-07-19 15:07:32.107 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.04133397954944018, Val Loss: 0.04460161274953468
2024-07-19 15:07:32.332 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.041339120349368534, Val Loss: 0.047837845578386974
2024-07-19 15:07:32.554 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.04035055274898942, Val Loss: 0.04420940336343404
2024-07-19 15:07:32.772 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.04154724532083885, Val Loss: 0.04544108632851292
2024-07-19 15:07:32.992 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.042086077703012, Val Loss: 0.045099059069478836
2024-07-19 15:07:33.225 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.04046610345107478, Val Loss: 0.044838043684894975
2024-07-19 15:07:33.444 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.040111112232143815, Val Loss: 0.04460942684798627
2024-07-19 15:07:33.661 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.04005925015017793, Val Loss: 0.046205616984012966
2024-07-19 15:07:33.887 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.039297943632747676, Val Loss: 0.04348769899759743
2024-07-19 15:07:34.104 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.04027998261153698, Val Loss: 0.043889932737157154
2024-07-19 15:07:34.324 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.04030377332221817, Val Loss: 0.042980366915061664
2024-07-19 15:07:34.538 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.03923941720780488, Val Loss: 0.04426667300631871
2024-07-19 15:07:34.755 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.04099750196611559, Val Loss: 0.04576913861406816
2024-07-19 15:07:34.971 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.03905187657958752, Val Loss: 0.04299506041649226
2024-07-19 15:07:35.187 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.038572238405814044, Val Loss: 0.04303382095452901
2024-07-19 15:07:35.405 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.03835057376607044, Val Loss: 0.04297692650878752
2024-07-19 15:07:35.621 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.03842062241322285, Val Loss: 0.042833202140959536
2024-07-19 15:07:35.853 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.03833934760375603, Val Loss: 0.04200404338740014
2024-07-19 15:07:35.854 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 0, MAPE: 3.21%
2024-07-19 15:07:36.233 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f0_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:07:36.679 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.03691841067414578, Val Loss: 0.03965695665494816
2024-07-19 15:07:37.039 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.03858288857218337, Val Loss: 0.040171995104567426
2024-07-19 15:07:37.394 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.04319456046166485, Val Loss: 0.03407213872147573
2024-07-19 15:07:37.798 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.04621623772872637, Val Loss: 0.0327195984286231
2024-07-19 15:07:38.198 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.04322377541293836, Val Loss: 0.03166458962132802
2024-07-19 15:07:38.560 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.04140656132710307, Val Loss: 0.031186714063625078
2024-07-19 15:07:38.924 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.039866092933775625, Val Loss: 0.030979045641583366
2024-07-19 15:07:39.298 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.03926853218103108, Val Loss: 0.030612823779921274
2024-07-19 15:07:39.661 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.038462128005411524, Val Loss: 0.030278474948293454
2024-07-19 15:07:40.017 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.03772029464375483, Val Loss: 0.029914286037957347
2024-07-19 15:07:40.426 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.03818209415735447, Val Loss: 0.030169345992239745
2024-07-19 15:07:40.788 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.0384114909764022, Val Loss: 0.030113593448658247
2024-07-19 15:07:41.143 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.037466859955289596, Val Loss: 0.029858266783727182
2024-07-19 15:07:41.515 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.037907563685758476, Val Loss: 0.03026368952280766
2024-07-19 15:07:41.875 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.03774497244660169, Val Loss: 0.0299373466420818
2024-07-19 15:07:42.256 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.03758526481177709, Val Loss: 0.02984210300083096
2024-07-19 15:07:42.621 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.037777811237802245, Val Loss: 0.030194996025513957
2024-07-19 15:07:43.006 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.03777669995308739, Val Loss: 0.029824583766025467
2024-07-19 15:07:43.365 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.03715394853218777, Val Loss: 0.02988868629610216
2024-07-19 15:07:43.738 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.03783857590225462, Val Loss: 0.029753003319775737
2024-07-19 15:07:44.098 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.03726623416559337, Val Loss: 0.030014032397318532
2024-07-19 15:07:44.468 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.03737833190148007, Val Loss: 0.029488900575686147
2024-07-19 15:07:44.827 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.037080843129182514, Val Loss: 0.030268647884194914
2024-07-19 15:07:45.184 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.03756886919679707, Val Loss: 0.029447719152714755
2024-07-19 15:07:45.544 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.03690172137360867, Val Loss: 0.029924464084812114
2024-07-19 15:07:45.912 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.037609904060420925, Val Loss: 0.029527792203668003
2024-07-19 15:07:46.287 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.03665734317204724, Val Loss: 0.029444642012586463
2024-07-19 15:07:46.654 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.03651971326605098, Val Loss: 0.029481898842228425
2024-07-19 15:07:47.031 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.0371395540359902, Val Loss: 0.02935918088297586
2024-07-19 15:07:47.404 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.03665558210484786, Val Loss: 0.029381788159544404
2024-07-19 15:07:47.767 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.03664250595316495, Val Loss: 0.029477007485724783
2024-07-19 15:07:48.140 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.036667506070169685, Val Loss: 0.02914847418464519
2024-07-19 15:07:48.502 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.03653246638913677, Val Loss: 0.02956532148291936
2024-07-19 15:07:48.876 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.03694799953229623, Val Loss: 0.029212542633349832
2024-07-19 15:07:49.252 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.036517594468920195, Val Loss: 0.029396216510920913
2024-07-19 15:07:49.632 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.03656588599391996, Val Loss: 0.029253443954764185
2024-07-19 15:07:50.022 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.03624129928138158, Val Loss: 0.028897492064012063
2024-07-19 15:07:50.407 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.036123789311067696, Val Loss: 0.028943878976074425
2024-07-19 15:07:50.788 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.03618693448705216, Val Loss: 0.02861131073252575
2024-07-19 15:07:51.173 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.036158784305396145, Val Loss: 0.02927373646682984
2024-07-19 15:07:51.557 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.036898419643714, Val Loss: 0.02933420245913235
2024-07-19 15:07:51.971 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.03635414740810656, Val Loss: 0.02900273463613278
2024-07-19 15:07:52.375 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.03629064166994944, Val Loss: 0.0290324656745872
2024-07-19 15:07:52.772 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.03623168581254678, Val Loss: 0.02902222444882264
2024-07-19 15:07:53.135 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.03605560940524487, Val Loss: 0.028783524257911218
2024-07-19 15:07:53.563 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.0360042160657579, Val Loss: 0.028742486006907514
2024-07-19 15:07:54.012 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.03596948240309546, Val Loss: 0.02850926450982287
2024-07-19 15:07:54.429 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.03619782491395735, Val Loss: 0.02907513263257774
2024-07-19 15:07:54.835 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.03591022303659622, Val Loss: 0.028768615243402688
2024-07-19 15:07:55.246 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.03594836786593476, Val Loss: 0.02866804846436591
2024-07-19 15:07:55.247 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 1, MAPE: 2.59%
2024-07-19 15:07:55.350 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f1_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:07:55.892 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.03284657419743863, Val Loss: 0.026962225149209436
2024-07-19 15:07:56.515 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.03319052644073963, Val Loss: 0.02725166057211322
2024-07-19 15:07:57.134 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.033492202853614636, Val Loss: 0.02785103249590139
2024-07-19 15:07:57.782 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.03394023857333443, Val Loss: 0.028803946651719713
2024-07-19 15:07:58.329 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.03449669023129073, Val Loss: 0.028049901228498767
2024-07-19 15:07:58.837 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.03325154097242789, Val Loss: 0.027292471681092237
2024-07-19 15:07:59.344 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.03298386479304596, Val Loss: 0.02691302468647828
2024-07-19 15:07:59.852 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.032677863809195434, Val Loss: 0.026939499468819517
2024-07-19 15:08:00.353 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.03251879448917779, Val Loss: 0.02723120807393177
2024-07-19 15:08:00.855 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.03249187831851569, Val Loss: 0.027072894965877402
2024-07-19 15:08:01.363 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.03272138449617407, Val Loss: 0.027573701900404854
2024-07-19 15:08:01.888 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.03268267224458131, Val Loss: 0.027320606734704326
2024-07-19 15:08:02.388 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.03254770504480058, Val Loss: 0.027382628388098768
2024-07-19 15:08:02.888 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.03248326695439491, Val Loss: 0.02751048609010271
2024-07-19 15:08:03.392 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.03247955363582481, Val Loss: 0.027793610116114486
2024-07-19 15:08:03.897 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.03379338521679694, Val Loss: 0.028678540794833285
2024-07-19 15:08:04.398 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.03384105845947157, Val Loss: 0.02834725586345067
2024-07-19 15:08:04.913 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.03323688041418791, Val Loss: 0.0275260131000667
2024-07-19 15:08:05.415 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.032805321856655856, Val Loss: 0.02725411075595263
2024-07-19 15:08:05.919 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.03283616542308168, Val Loss: 0.027724323743903958
2024-07-19 15:08:06.425 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.03297987578606064, Val Loss: 0.027476239647414233
2024-07-19 15:08:06.924 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.0327053504911336, Val Loss: 0.027710098773241043
2024-07-19 15:08:07.432 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.03231213033537973, Val Loss: 0.02674155934034167
2024-07-19 15:08:07.930 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.03269786172631112, Val Loss: 0.02725680746339463
2024-07-19 15:08:08.432 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.032789245942099525, Val Loss: 0.027945296939563106
2024-07-19 15:08:08.933 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.032941222986714404, Val Loss: 0.02743089516219255
2024-07-19 15:08:09.440 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.032398582419211217, Val Loss: 0.027058065894085007
2024-07-19 15:08:09.945 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.03245893982662396, Val Loss: 0.027539115801856324
2024-07-19 15:08:10.446 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.03220607709478248, Val Loss: 0.026841242118058977
2024-07-19 15:08:10.961 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.03239655447277156, Val Loss: 0.027476858951755473
2024-07-19 15:08:11.464 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.03235514143651182, Val Loss: 0.026989137200084893
2024-07-19 15:08:11.973 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.0324674072929404, Val Loss: 0.027107016258948558
2024-07-19 15:08:12.474 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.032139169018376955, Val Loss: 0.026979818789137376
2024-07-19 15:08:12.981 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.032224813069809566, Val Loss: 0.026923665072064142
2024-07-19 15:08:13.490 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.032079896906560115, Val Loss: 0.02698343901618107
2024-07-19 15:08:13.989 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.032157680730928076, Val Loss: 0.0270770505775471
2024-07-19 15:08:14.493 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.03206351529806852, Val Loss: 0.026656729748120177
2024-07-19 15:08:14.993 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.03247079803523692, Val Loss: 0.02686392334667412
2024-07-19 15:08:15.498 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.03190780690109188, Val Loss: 0.02670071500580053
2024-07-19 15:08:15.999 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.032117162306200375, Val Loss: 0.02664681035723235
2024-07-19 15:08:16.513 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.03214940855448896, Val Loss: 0.026902963835242634
2024-07-19 15:08:17.012 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.03207944379272786, Val Loss: 0.02735171462031635
2024-07-19 15:08:17.520 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.03207829660651359, Val Loss: 0.026867992068464693
2024-07-19 15:08:18.020 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.032114232280714944, Val Loss: 0.027031073799809895
2024-07-19 15:08:18.520 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.03218822443688458, Val Loss: 0.027418308664818068
2024-07-19 15:08:19.027 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.03255900313908404, Val Loss: 0.027783909762227856
2024-07-19 15:08:19.530 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.033505328981713815, Val Loss: 0.027738534719557374
2024-07-19 15:08:20.039 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.03269326199184765, Val Loss: 0.027306135492147627
2024-07-19 15:08:20.536 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.032510936598886146, Val Loss: 0.027263404096703272
2024-07-19 15:08:21.050 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.03248160362920978, Val Loss: 0.02759102012055951
2024-07-19 15:08:21.050 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 2, MAPE: 2.72%
2024-07-19 15:08:21.151 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f2_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:08:21.827 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.03143719473394425, Val Loss: 0.03325181721231422
2024-07-19 15:08:22.525 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.03141124073211869, Val Loss: 0.03264639652460008
2024-07-19 15:08:23.215 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.03118399558716441, Val Loss: 0.03275497610101829
2024-07-19 15:08:23.877 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.031056913738585497, Val Loss: 0.03263888835302881
2024-07-19 15:08:24.526 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.031052326464591776, Val Loss: 0.03288822570765341
2024-07-19 15:08:25.172 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.031022890394374933, Val Loss: 0.033459308733408515
2024-07-19 15:08:25.826 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.030926810526480414, Val Loss: 0.033248726228201714
2024-07-19 15:08:26.479 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.030922568607309908, Val Loss: 0.03336223612564641
2024-07-19 15:08:27.147 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.03094955439334863, Val Loss: 0.033638637311555246
2024-07-19 15:08:27.830 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.03088520048824075, Val Loss: 0.03364362899918814
2024-07-19 15:08:28.504 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.031008098274469376, Val Loss: 0.03279340977000224
2024-07-19 15:08:29.180 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.03088138082817401, Val Loss: 0.032836162460011406
2024-07-19 15:08:29.853 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.030725294813411692, Val Loss: 0.03356996772659791
2024-07-19 15:08:30.574 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.03083240937390556, Val Loss: 0.03310372932134448
2024-07-19 15:08:31.263 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.030876555429031588, Val Loss: 0.03306398143035334
2024-07-19 15:08:31.966 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.030815946729215858, Val Loss: 0.033493411047635854
2024-07-19 15:08:32.635 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.030785274245355227, Val Loss: 0.0331235607028813
2024-07-19 15:08:33.304 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.030667328428834267, Val Loss: 0.033277808965460676
2024-07-19 15:08:33.986 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.030588042016511094, Val Loss: 0.03349242434912437
2024-07-19 15:08:34.659 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.030898660395855773, Val Loss: 0.033911087726419036
2024-07-19 15:08:35.328 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.030854704292261437, Val Loss: 0.033362910403190435
2024-07-19 15:08:36.015 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.030864284067631583, Val Loss: 0.03325284071065284
2024-07-19 15:08:36.688 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.030634783705926105, Val Loss: 0.03316149850552146
2024-07-19 15:08:37.357 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.030682338758894843, Val Loss: 0.033662087560908216
2024-07-19 15:08:38.028 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.030756638768090778, Val Loss: 0.03355310444493551
2024-07-19 15:08:38.692 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.03076883587884168, Val Loss: 0.0338616246810636
2024-07-19 15:08:39.366 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.030680379970637085, Val Loss: 0.03376196732593549
2024-07-19 15:08:40.048 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.03053968994278614, Val Loss: 0.0338327358602672
2024-07-19 15:08:40.721 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.03051279486501462, Val Loss: 0.033848778218836396
2024-07-19 15:08:41.411 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.03062904539377722, Val Loss: 0.03362319990992546
2024-07-19 15:08:42.093 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.030384240238225623, Val Loss: 0.033124699030776285
2024-07-19 15:08:42.766 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.03039158790129913, Val Loss: 0.03376814556887021
2024-07-19 15:08:43.433 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.030225026842257748, Val Loss: 0.033511999742807566
2024-07-19 15:08:44.106 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.03031433705393582, Val Loss: 0.034048809191665134
2024-07-19 15:08:44.810 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.030204135171864946, Val Loss: 0.033645546265147826
2024-07-19 15:08:45.469 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.030288311155283288, Val Loss: 0.03347506469770058
2024-07-19 15:08:46.145 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.030116484168763846, Val Loss: 0.033819376969256916
2024-07-19 15:08:46.811 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.03018917647279697, Val Loss: 0.03408045648924402
2024-07-19 15:08:47.482 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.030269162002185435, Val Loss: 0.03455443272518145
2024-07-19 15:08:48.158 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.030154332186873644, Val Loss: 0.03453944482513376
2024-07-19 15:08:48.829 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.030144967406681957, Val Loss: 0.03442783089908394
2024-07-19 15:08:49.508 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.030163660313780993, Val Loss: 0.03365449672816573
2024-07-19 15:08:50.190 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.030053700333180493, Val Loss: 0.03411884626021256
2024-07-19 15:08:50.866 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.030257333542079958, Val Loss: 0.03322340608448596
2024-07-19 15:08:51.577 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.02978156415158755, Val Loss: 0.03418839586949026
2024-07-19 15:08:52.264 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.030096869201284564, Val Loss: 0.03353581990341883
2024-07-19 15:08:52.943 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.03010225538419534, Val Loss: 0.033397554092713305
2024-07-19 15:08:53.599 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.03009593272454118, Val Loss: 0.03317842194558801
2024-07-19 15:08:54.265 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.029913274418205432, Val Loss: 0.032902567722910156
2024-07-19 15:08:54.927 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.029875071681015296, Val Loss: 0.033104389100461394
2024-07-19 15:08:54.928 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 3, MAPE: 3.04%
2024-07-19 15:08:55.027 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f3_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:08:55.833 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 1/50, Train Loss: 0.030065400541279014, Val Loss: 0.041756289734228236
2024-07-19 15:08:56.676 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 2/50, Train Loss: 0.029463400383694813, Val Loss: 0.04309492658924412
2024-07-19 15:08:57.508 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 3/50, Train Loss: 0.029696096492173907, Val Loss: 0.04494181637828414
2024-07-19 15:08:58.336 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 4/50, Train Loss: 0.029684728973514433, Val Loss: 0.04671531825049503
2024-07-19 15:08:59.174 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 5/50, Train Loss: 0.029769239102868914, Val Loss: 0.049228780273650144
2024-07-19 15:09:00.001 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 6/50, Train Loss: 0.02984181845274109, Val Loss: 0.04747025779372937
2024-07-19 15:09:00.845 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 7/50, Train Loss: 0.029819623515992374, Val Loss: 0.04813301412237657
2024-07-19 15:09:01.740 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 8/50, Train Loss: 0.029876574976267396, Val Loss: 0.04631947816626446
2024-07-19 15:09:02.605 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 9/50, Train Loss: 0.029787088539656045, Val Loss: 0.04661983100546373
2024-07-19 15:09:03.425 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 10/50, Train Loss: 0.029840404618081157, Val Loss: 0.041625653016003406
2024-07-19 15:09:04.262 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 11/50, Train Loss: 0.029527508121516024, Val Loss: 0.0449652313380628
2024-07-19 15:09:05.095 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 12/50, Train Loss: 0.029486024051208745, Val Loss: 0.0397438297702654
2024-07-19 15:09:05.923 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 13/50, Train Loss: 0.029411714247704206, Val Loss: 0.04358296876622213
2024-07-19 15:09:06.748 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 14/50, Train Loss: 0.029357634955546358, Val Loss: 0.04119713473561648
2024-07-19 15:09:07.576 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 15/50, Train Loss: 0.02938381040079908, Val Loss: 0.04185626237980417
2024-07-19 15:09:08.414 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 16/50, Train Loss: 0.02940556095851647, Val Loss: 0.041051585781010425
2024-07-19 15:09:09.253 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 17/50, Train Loss: 0.029397498539925276, Val Loss: 0.0438032744301332
2024-07-19 15:09:10.088 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 18/50, Train Loss: 0.02930669509549881, Val Loss: 0.03881567132634085
2024-07-19 15:09:10.925 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 19/50, Train Loss: 0.02922665622023927, Val Loss: 0.041825865621905066
2024-07-19 15:09:11.777 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 20/50, Train Loss: 0.02931192871899559, Val Loss: 0.04026881132174183
2024-07-19 15:09:12.604 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 21/50, Train Loss: 0.029067123319012123, Val Loss: 0.03932534767365133
2024-07-19 15:09:13.448 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 22/50, Train Loss: 0.02917080069124535, Val Loss: 0.0414111273916992
2024-07-19 15:09:14.279 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 23/50, Train Loss: 0.02918580048052328, Val Loss: 0.0374753057856012
2024-07-19 15:09:15.108 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 24/50, Train Loss: 0.029192409703282865, Val Loss: 0.04317062801203212
2024-07-19 15:09:15.937 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 25/50, Train Loss: 0.029179408834162323, Val Loss: 0.04006489683446046
2024-07-19 15:09:16.772 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 26/50, Train Loss: 0.02917934877920773, Val Loss: 0.043181130813585746
2024-07-19 15:09:17.572 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 27/50, Train Loss: 0.029163486221907557, Val Loss: 0.04314817115664482
2024-07-19 15:09:18.376 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 28/50, Train Loss: 0.029116089542775034, Val Loss: 0.039087463975758165
2024-07-19 15:09:19.179 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 29/50, Train Loss: 0.02897516094598469, Val Loss: 0.03962500745782981
2024-07-19 15:09:19.981 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 30/50, Train Loss: 0.028971569290241368, Val Loss: 0.0383226953044131
2024-07-19 15:09:20.784 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 31/50, Train Loss: 0.02892070619266603, Val Loss: 0.036943493864020786
2024-07-19 15:09:21.607 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 32/50, Train Loss: 0.029043317905494144, Val Loss: 0.04008657006999931
2024-07-19 15:09:22.421 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 33/50, Train Loss: 0.02902827032708696, Val Loss: 0.0369392587627108
2024-07-19 15:09:23.225 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 34/50, Train Loss: 0.028924308850296905, Val Loss: 0.0381389702292713
2024-07-19 15:09:24.054 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 35/50, Train Loss: 0.028894581059300966, Val Loss: 0.037027892077694066
2024-07-19 15:09:24.875 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 36/50, Train Loss: 0.028907178558286402, Val Loss: 0.03805289830307703
2024-07-19 15:09:25.702 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 37/50, Train Loss: 0.028870226641359565, Val Loss: 0.03770607991798504
2024-07-19 15:09:26.550 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 38/50, Train Loss: 0.028746044790310846, Val Loss: 0.035673930083174966
2024-07-19 15:09:27.378 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 39/50, Train Loss: 0.028798783970689707, Val Loss: 0.036790621995523166
2024-07-19 15:09:28.208 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 40/50, Train Loss: 0.028687764516939503, Val Loss: 0.036270944854697666
2024-07-19 15:09:29.049 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 41/50, Train Loss: 0.02876419936317009, Val Loss: 0.03828186305189455
2024-07-19 15:09:29.871 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 42/50, Train Loss: 0.02872197841202001, Val Loss: 0.03571414177280825
2024-07-19 15:09:30.689 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 43/50, Train Loss: 0.028685245703864885, Val Loss: 0.03503877055403348
2024-07-19 15:09:31.537 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 44/50, Train Loss: 0.02861067196251927, Val Loss: 0.03425022743239596
2024-07-19 15:09:32.391 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 45/50, Train Loss: 0.02867555620844711, Val Loss: 0.03782854974269867
2024-07-19 15:09:33.225 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 46/50, Train Loss: 0.02851995676858248, Val Loss: 0.03629346212019791
2024-07-19 15:09:34.061 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 47/50, Train Loss: 0.02872170727433903, Val Loss: 0.03671510628349072
2024-07-19 15:09:34.892 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 48/50, Train Loss: 0.028647470600125225, Val Loss: 0.03591037496320299
2024-07-19 15:09:35.720 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 49/50, Train Loss: 0.028668901755136776, Val Loss: 0.037055213809818834
2024-07-19 15:09:36.559 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Epoch 50/50, Train Loss: 0.028548789410186664, Val Loss: 0.03678788979713981
2024-07-19 15:09:36.559 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Fold 4, MAPE: 3.05%
2024-07-19 15:09:36.668 [21/cross_validate_train/257 (pid 11931)] INFO:__main__:Training image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//train_f4_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:09:41.222 [21/cross_validate_train/257 (pid 11931)] Task finished successfully.
2024-07-19 15:09:41.247 [21/model_scores/258 (pid 12521)] Task is starting.
2024-07-19 15:09:42.839 [21/model_scores/258 (pid 12521)] INFO:__main__:Average Train Loss across all folds: 0.0330386360380205
2024-07-19 15:09:47.118 [21/model_scores/258 (pid 12521)] INFO:__main__:Average Validation Loss across all folds: 0.03363107817398535
2024-07-19 15:09:47.119 [21/model_scores/258 (pid 12521)] INFO:__main__:Average MAPE across all folds: 2.92%
2024-07-19 15:09:47.120 [21/model_scores/258 (pid 12521)] Task finished successfully.
2024-07-19 15:09:47.153 [21/validate_model/259 (pid 12569)] Task is starting.
2024-07-19 15:09:48.670 [21/validate_model/259 (pid 12569)] INFO:__main__:Validating LSTM on test set..
2024-07-19 15:09:48.875 [21/validate_model/259 (pid 12569)] INFO:__main__:Test Set MAPE: 3.95%
2024-07-19 15:09:49.294 [21/validate_model/259 (pid 12569)] INFO:__main__:Test image saved at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//test_bgd_lodging_residential_50001_100000_LSTM.png
2024-07-19 15:09:49.809 [21/validate_model/259 (pid 12569)] Task finished successfully.
2024-07-19 15:09:49.853 [21/log_model/260 (pid 12589)] Task is starting.
2024-07-19 15:09:51.427 [21/log_model/260 (pid 12589)] INFO:__main__:Logging model bgd_lodging_residential_50001_100000_LSTM
2024-07-19 15:09:51.428 [21/log_model/260 (pid 12589)] INFO:__main__:Model logged at metaflow_models//bgd_lodging_residential_50001_100000_LSTM//bgd_lodging_residential_50001_100000_LSTM.pth
2024-07-19 15:09:55.679 [21/log_model/260 (pid 12589)] Task finished successfully.
2024-07-19 15:09:55.706 [21/end/261 (pid 12629)] Task is starting.
2024-07-19 15:09:57.242 [21/end/261 (pid 12629)] INFO:__main__:Pipeline end.
2024-07-19 15:09:57.564 [21/end/261 (pid 12629)] Task finished successfully.
2024-07-19 15:09:57.564 Done!

-- stderr --
Metaflow 2.12.8 executing BGD_LinearFlow for user:nikhilkapila
Validating your flow...
    The graph looks good!

